<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="google-site-verification" content="Fn8ri9RLegwF2izp3g2BTQ5UrPZNY5ehkJ-U6vlHrMM" />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FII DII Data Activity | Track Institutional Investments</title>
  <!-- Bootstrap 5.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <!-- html2canvas for snapshot download -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <style>
    :root {
      --primary: #1e40af;
      --secondary: #4b5563;
      --success: #10b981;
      --danger: #ef4444;
      --light-bg: #f8fafc;
      --dark-bg: #1e293b;
      --accent: #6366f1; /* Purple for AI vibe */
      --neon: #0ea5e9;   /* Neon blue for highlights */
    }
    /* Base Styles */
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--light-bg);
      color: #1e293b;
      line-height: 1.6;
      scroll-behavior: smooth;
      padding-top: 80px;
      transition: background-color 0.3s, color 0.3s;
    }
    .navbar {
      background: white;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      padding: 1rem;
      transition: background 0.3s;
    }
    .navbar-brand {
      font-weight: 800;
      color: var(--primary) !important;
      font-size: 1.5rem;
      letter-spacing: 0.5px;
    }
    .nav-link {
      color: #64748b !important;
      font-weight: 500;
      padding: 0.75rem 1.25rem;
      transition: color 0.3s;
    }
    .nav-link:hover {
      color: var(--primary) !important;
    }
    .dropdown-menu a {
      color: #1e293b;
      transition: color 0.3s;
    }
    .dropdown-menu a:hover {
      color: var(--primary);
    }
    .form-switch .form-check-input {
      width: 2.5em;
      height: 1.5em;
      margin-left: -2.5em;
      cursor: pointer;
    }
    .form-switch .form-check-input:checked {
      background-color: var(--primary);
      border-color: var(--primary);
    }
    .form-switch .form-check-label {
      margin-left: 2.8em;
      cursor: pointer;
    }
    /* Header Styles */
    .header {
      padding: 40px 0 20px;
      background: linear-gradient(135deg, #ffffff 0%, #e0e7ff 100%);
      border-bottom: 1px solid #e2e8f0;
      text-align: center;
      transition: background 0.3s;
    }
    .header h1 {
      font-size: 2.8rem;
      font-weight: 800;
      color: #1e293b;
      margin-bottom: 0.75rem;
      letter-spacing: 0.5px;
      transition: color 0.3s;
    }
    .header p {
      font-size: 1.3rem;
      color: #64748b;
      max-width: 900px;
      margin: 0 auto 1rem;
    }
    /* Stat Row */
    .stat-row {
      margin-top: 2rem;
    }
    .stat-box {
      background: white;
      padding: 1.75rem;
      border-radius: 12px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      transition: background 0.3s;
      border-left: 4px solid var(--accent);
    }
    .stat-value {
      font-size: 2.5rem;
      font-weight: 900;
      margin: 0.75rem 0;
    }
    /* Share Container */
    .share-container {
      background: #fff;
      border: 1px solid #e2e8f0;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
      border-radius: 10px;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      padding: 1rem;
      margin-top: 1.5rem;
      gap: 1rem;
      justify-content: center;
    }
    .share-container span {
      font-weight: 600;
      color: #4b5563;
      font-size: 1.2rem;
    }
    .share-icon {
      font-size: 1.5rem;
      color: var(--primary);
      cursor: pointer;
      transition: transform 0.3s ease, color 0.3s ease;
    }
    .share-icon:hover {
      transform: scale(1.2);
      color: var(--accent);
    }
    .download-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      transition: background 0.3s ease, transform 0.2s ease;
    }
    .download-btn:hover {
      background: var(--accent);
      transform: scale(1.05);
    }
    .download-btn:active {
      transform: scale(0.95);
    }
    .download-select {
      margin-left: 0.5rem;
      border: 1px solid #ced4da;
      border-radius: 4px;
      padding: 0.25rem 0.5rem;
      background: #fff;
      font-size: 1rem;
    }
    /* Card & Table Styles */
    .card {
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      margin-bottom: 30px;
      background: white;
    }
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    .card-header {
      background: white;
      border-bottom: 1px solid #e2e8f0;
      font-weight: 700;
      color: #1e293b;
      padding: 1.5rem;
      border-radius: 16px 16px 0 0;
      transition: background 0.3s, color 0.3s;
    }
    .table {
      margin-bottom: 0;
      border-radius: 0 0 16px 16px;
      overflow: hidden;
    }
    .table thead th {
      background-color: #f8fafc;
      color: #64748b;
      font-weight: 600;
      border-bottom: 2px solid #e2e8f0;
      padding: 1.5rem;
      transition: background 0.3s, color 0.3s;
    }
    .table td {
      vertical-align: middle;
      padding: 1.5rem;
      border-top: 1px solid #e2e8f0;
    }
    .table tbody tr:hover {
      background: #f1f5f9;
      transition: background 0.2s;
    }
    .net-positive {
      color: var(--success) !important;
      font-weight: 600;
    }
    .net-negative {
      color: var(--danger) !important;
      font-weight: 600;
    }
    .chart-container {
      height: 400px;
      position: relative;
      background: white;
      padding: 1.5rem;
      border-radius: 16px;
    }
    /* Article Section */
    .article-section {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      padding: 2.5rem;
      margin: 4rem 0;
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
      transition: background 0.3s, color 0.3s;
    }
    .article-section h2 {
      font-weight: 800;
      color: #1e293b;
      margin-bottom: 1.5rem;
      transition: color 0.3s;
    }
    .article-section h3 {
      font-weight: 700;
      color: #1e293b;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
    }
    .article-section p,
    .article-section li {
      font-size: 1rem;
      color: #4b5563;
      transition: color 0.3s;
    }
    /* Footer */
    footer {
      background: #1e293b;
      padding: 2rem;
      margin-top: 4rem;
      text-align: center;
      color: #ffffff;
      font-size: 0.95rem;
      transition: background 0.3s;
    }
    .footer-links a {
      color: #f8fafc;
      text-decoration: none;
      margin: 0 0.5rem;
      transition: color 0.3s;
    }
    .footer-links a:hover {
      color: var(--primary);
    }
    .scroll-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--primary);
      color: white;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      transition: all 0.3s;
      opacity: 0;
      visibility: hidden;
    }
    .scroll-to-top.show {
      opacity: 1;
      visibility: visible;
    }
    /* Dark Mode */
    .dark-mode {
      background-color: var(--dark-bg);
      color: #f8fafc;
    }
    .dark-mode .text-muted {
      color: #cbd5e1 !important;
    }
    .dark-mode .text-success {
      color: var(--success) !important;
    }
    .dark-mode .text-danger {
      color: var(--danger) !important;
    }
    .dark-mode .navbar {
      background: var(--dark-bg);
      box-shadow: 0 4px 12px rgba(255,255,255,0.1);
    }
    .dark-mode .navbar-brand {
      color: var(--success) !important;
    }
    .dark-mode .nav-link {
      color: #f8fafc !important;
    }
    .dark-mode .dropdown-menu {
      background: var(--dark-bg);
      border-color: #475569;
    }
    .dark-mode .dropdown-menu a {
      color: #f8fafc;
    }
    .dark-mode .dropdown-menu a:hover {
      color: var(--primary);
    }
    .dark-mode .header {
      background: linear-gradient(135deg, var(--dark-bg) 0%, #312e81 100%);
    }
    .dark-mode .header h1 {
      color: #f8fafc;
    }
    .dark-mode .header p {
      color: #cbd5e1;
    }
    .dark-mode .stat-box {
      background: var(--dark-bg);
      border-left-color: var(--neon);
    }
    .dark-mode .card {
      background: #334155;
      border-color: #475569;
    }
    .dark-mode .card-header {
      background: var(--dark-bg);
      border-bottom: 1px solid #475569;
      color: #f8fafc;
    }
    .dark-mode .table thead th {
      background-color: var(--dark-bg);
      color: #f8fafc;
    }
    .dark-mode .table td {
      border-top: 1px solid #475569;
    }
    .dark-mode .table tbody tr:hover {
      background: #475569;
    }
    .dark-mode .article-section {
      background: var(--dark-bg);
      border-color: #475569;
      color: #f8fafc;
    }
    .dark-mode .article-section h2,
    .dark-mode .article-section h3 {
      color: #f8fafc !important;
    }
    .dark-mode .article-section p {
      color: #cbd5e1 !important;
    }
    .dark-mode .footer-links a {
      color: #f8fafc;
    }
    .dark-mode footer {
      background: #0f172a;
    }
    .dark-mode .navbar-toggler-icon {
      filter: invert(1);
    }
    /* Media Queries for Responsiveness */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 2rem;
      }
      .header p {
        font-size: 1rem;
      }
      .stat-value {
        font-size: 1.8rem;
      }
      .share-container {
        flex-direction: column;
      }
      .share-icon {
        font-size: 1.8rem;
      }
      .download-btn {
        margin-top: 1rem;
      }
      .table thead th, .table td {
        padding: 1rem;
      }
      .card {
        margin-bottom: 20px;
      }
    }
  </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#navbar">
  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top">
    <div class="container">
      <a class="navbar-brand" href="#home">
        <i class="fas fa-chart-line me-2"></i>FII DII DATA
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item"><a class="nav-link active" href="#home">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" href="#fii">FII Activity</a></li>
          <li class="nav-item"><a class="nav-link" href="#dii">DII Activity</a></li>
          <li class="nav-item"><a class="nav-link" href="#trends">Trends</a></li>
          <li class="nav-item"><a class="nav-link" href="#features">Features</a></li>
          <!-- Dropdown for Info Pages -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="infoDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Info
            </a>
            <ul class="dropdown-menu" aria-labelledby="infoDropdown">
              <li><a class="dropdown-item" href="about.html">About Us</a></li>
              <li><a class="dropdown-item" href="privacy.html">Privacy Policy</a></li>
              <li><a class="dropdown-item" href="contact.html">Contact Us</a></li>
            </ul>
          </li>
          <!-- Dark Mode Toggle -->
          <li class="nav-item ms-3">
            <div class="form-check form-switch">
              <input class="form-check-input" type="checkbox" id="darkModeToggle">
              <label class="form-check-label" for="darkModeToggle">Dark Mode</label>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Header -->
  <header class="header" id="home">
    <div class="container text-center">
      <h1>FII DII Data</h1>
      <p class="mb-3">Track Foreign and Domestic Institutional Investments with Ease</p>
      <!-- Latest Data Date and Stats -->
      <div id="latestDateText" class="mb-4 text-muted"></div>
      <!-- Stat Row -->
      <div class="row justify-content-center g-4 stat-row" id="snapshotArea">
        <div class="col-md-5 col-lg-4">
          <div class="stat-box">
            <div class="text-muted">FII Net Buy</div>
            <div class="stat-value" id="headerFii"></div>
            <div class="text-success small" id="fiiChangeText"></div>
          </div>
        </div>
        <div class="col-md-5 col-lg-4">
          <div class="stat-box">
            <div class="text-muted">DII Net Buy</div>
            <div class="stat-value" id="headerDii"></div>
            <div class="text-danger small" id="diiChangeText"></div>
          </div>
        </div>
      </div>
      <!-- Simplified Share Section with Icons Only -->
      <div class="share-container">
        <span>Share:</span>
        <i class="fab fa-facebook-square share-icon" onclick="shareOnFacebook()" data-bs-toggle="tooltip" title="Share on Facebook"></i>
        <i class="fab fa-twitter-square share-icon" onclick="shareOnTwitter()" data-bs-toggle="tooltip" title="Share on Twitter"></i>
        <i class="fab fa-linkedin share-icon" onclick="shareOnLinkedIn()" data-bs-toggle="tooltip" title="Share on LinkedIn"></i>
        <i class="fab fa-whatsapp-square share-icon" onclick="shareOnWhatsApp()" data-bs-toggle="tooltip" title="Share on WhatsApp"></i>
        <i class="fab fa-instagram-square share-icon" onclick="copyLinkForInstagram()" data-bs-toggle="tooltip" title="Copy link for Instagram"></i>
        <i class="fab fa-telegram share-icon" onclick="shareOnTelegram()" data-bs-toggle="tooltip" title="Share on Telegram"></i>
        <i class="fas fa-link share-icon" onclick="copyLink()" data-bs-toggle="tooltip" title="Copy Link"></i>
        <!-- Download Options -->
        <button class="download-btn" onclick="downloadSnapshot()">
          <i class="fas fa-download"></i> Download Snapshot
        </button>
        <select id="downloadFormat" class="download-select">
          <option value="PNG">PNG</option>
          <option value="JPEG">JPEG</option>
          <option value="CSV">CSV</option>
        </select>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <div class="container py-5">
    <div class="row g-4">
      <!-- FII Table -->
      <div class="col-lg-6" id="fii">
        <div class="card">
          <div class="card-header">
            <i class="fas fa-globe me-2"></i>FII Activity
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Date (Day)</th>
                    <th class="text-end">Buy (₹ Cr)</th>
                    <th class="text-end">Sell (₹ Cr)</th>
                    <th class="text-end">Net (₹ Cr)</th>
                  </tr>
                </thead>
                <tbody id="fiiTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- DII Table -->
      <div class="col-lg-6" id="dii">
        <div class="card">
          <div class="card-header">
            <i class="fas fa-landmark me-2"></i>DII Activity
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>Date (Day)</th>
                    <th class="text-end">Buy (₹ Cr)</th>
                    <th class="text-end">Sell (₹ Cr)</th>
                    <th class="text-end">Net (₹ Cr)</th>
                  </tr>
                </thead>
                <tbody id="diiTableBody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- Chart -->
      <div class="col-12" id="trends">
        <div class="card">
          <div class="card-header">
            <i class="fas fa-chart-line me-2"></i>Investment Trends
          </div>
          <div class="card-body">
            <div class="chart-container">
              <canvas id="investmentChart"></canvas>
            </div>
          </div>
        </div>
      </div>
      <!-- Article Sections -->
      <div class="col-12" id="features">
        <div class="article-section">
          <h2>Understanding Institutional Investments</h2>
          <p>Foreign Institutional Investors (FIIs) and Domestic Institutional Investors (DIIs) play a crucial role in shaping market trends. Our platform provides real-time data, historical performance analysis, and smart alerts to help you identify opportunities and make informed decisions. Explore our advanced tools to stay ahead in the dynamic market environment.</p>
          <p>Foreign Institutional Investors (FIIs) and Domestic Institutional Investors (DIIs) play a crucial role in shaping market trends. Our platform provides:</p>
          <ul>
            <li><i class="fas fa-clock"></i> Real-time tracking of investment patterns</li>
            <li><i class="fas fa-history"></i> Historical performance analysis</li>
            <li><i class="fas fa-bell"></i> Smart alert system for significant changes</li>
          </ul>
          <p>With our advanced tools, you can monitor market movements, identify opportunities, and make informed decisions based on institutional behavior.</p>
        </div>
      </div>
      <div class="col-12">
        <div class="article-section">
          <h2>Understanding FII DII Data</h2>
          <p>FII DII data is basically a snapshot of how much foreign and domestic institutions are buying or selling in the stock market. FIIs are the big money managers from abroad who invest in Indian stocks. Think mutual funds, hedge funds, pension funds, etc. based outside India. DIIs, on the other hand, are homegrown players like domestic mutual funds, insurance companies, banks and other financial institutions that deploy funds in Indian equities.</p>
          
          <h3>Understanding FII DII Activity in Cash Segment</h3>
         
          <h3>Why is FII DII Data Important for Traders?</h3>
      
        </div>
      </div>
    </div
  </div>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-links mb-2">
        <a href="#home">Home</a> |
        <a href="about.html">About Us</a> |
        <a href="privacy.html">Privacy Policy</a> |
        <a href="contact.html">Contact Us</a>
      </div>
      <p>© 2025 FII DII Data Activity. All market data sourced from NSE and NSDL.</p>
    </div>
  </footer>

  <!-- Scroll to Top -->
  <div class="scroll-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
    <i class="fas fa-chevron-up"></i>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    // Define holiday dates (if any)
    const HOLIDAYS = [];

    // Data arrays
  const fiiData = [
  { date: "2025-05-05", buy: 9365.89, sell: 8868.1, net: 497.79 },
  { date: "2025-05-02", buy: 18130.19, sell: 15360.38, net: 2769.81 },
  { date: "2025-03-28", buy: 11508.47, sell: 15861.29, net: -4352.82 },
  { date: "2025-03-27", buy: 31783.75, sell: 20672.5, net: 11111.25 },
  { date: "2025-03-26", buy: 14316.32, sell: 12075.77, net: 2240.55 },
  { date: "2025-03-25", buy: 19066.28, sell: 13694.71, net: 5371.57 },
  { date: "2025-03-24", buy: 15777.73, sell: 12721.97, net: 3055.76 },
  { date: "2025-03-21", buy: 49892.65, sell: 42422.29, net: 7470.36 },
  { date: "2025-03-20", buy: 16328.06, sell: 13088.92, net: 3239.14 },
  { date: "2025-03-19", buy: 15718.73, sell: 16815.23, net: -1096.5 },
  { date: "2025-03-18", buy: 15709.88, sell: 15015.31, net: 694.57 },
  { date: "2025-03-17", buy: 11262.99, sell: 15751.44, net: -4488.45 },
  { date: "2025-03-13", buy: 11601.09, sell: 12393.99, net: -792.9 },
  { date: "2025-03-12", buy: 13088.94, sell: 14716.55, net: -1627.61 },
  { date: "2025-03-11", buy: 8214.28, sell: 11038.04, net: -2823.76 },
  // Existing April entries retained here...
];

const diiData = [
  { date: "2025-05-05", buy: 13917.99, sell: 11129.33, net: 2788.66 },
  { date: "2025-05-02", buy: 13906.16, sell: 10615.67, net: 3290.49 },
  { date: "2025-03-28", buy: 16920.46, sell: 9273.97, net: 7646.49 },
  { date: "2025-03-27", buy: 39853.05, sell: 37335.35, net: 2517.7 },
  { date: "2025-03-26", buy: 12416.37, sell: 13112.74, net: -696.37 },
  { date: "2025-03-25", buy: 11692.98, sell: 14461.85, net: -2768.87 },
  { date: "2025-03-24", buy: 12879.29, sell: 12780.75, net: 98.54 },
  { date: "2025-03-21", buy: 18878.93, sell: 22081.19, net: -3202.26 },
  { date: "2025-03-20", buy: 11784.06, sell: 14920.08, net: -3136.02 },
  { date: "2025-03-19", buy: 13300.08, sell: 11159.32, net: 2140.76 },
  { date: "2025-03-18", buy: 12333.09, sell: 9798.34, net: 2534.75 },
  { date: "2025-03-17", buy: 12726.1, sell: 6725.5, net: 6000.6 },
  { date: "2025-03-13", buy: 10032.41, sell: 8308.59, net: 1723.82 },
  { date: "2025-03-12", buy: 11803.42, sell: 10293.07, net: 1510.35 },
  { date: "2025-03-11", buy: 10895.62, sell: 8893.83, net: 2001.79 },
  // Existing April entries retained here...
];



    // Helper: Format Date
    function formatDateWithDay(isoString) {
      const dateObj = new Date(isoString);
      const weekday = dateObj.toLocaleDateString('en-US', { weekday: 'short' });
      const dayMonth = dateObj.toLocaleDateString('en-US', { day: '2-digit', month: 'short' });
      return `${isoString} (${weekday}), ${dayMonth}`;
    }

    // Populate Tables
    function populateTable(tbodyId, data) {
      const tbody = document.getElementById(tbodyId);
      tbody.innerHTML = data.map(item => {
        if (HOLIDAYS.includes(item.date)) {
          return `
            <tr>
              <td>${formatDateWithDay(item.date)}</td>
              <td class="text-end">Closed</td>
              <td class="text-end">Closed</td>
              <td class="text-end net-negative">Closed</td>
            </tr>
          `;
        }
        const netSign = item.net >= 0 ? "+" : "-";
        const netVal = Math.abs(item.net).toLocaleString('en-IN');
        const netClass = item.net >= 0 ? "net-positive" : "net-negative";
        return `
          <tr>
            <td>${formatDateWithDay(item.date)}</td>
            <td class="text-end">₹${item.buy.toLocaleString('en-IN')}</td>
            <td class="text-end">₹${item.sell.toLocaleString('en-IN')}</td>
            <td class="text-end ${netClass}">${netSign}₹${netVal}</td>
          </tr>
        `;
      }).join("");
    }
    populateTable("fiiTableBody", fiiData);
    populateTable("diiTableBody", diiData);

    // Animation for Stat Values
    function animateNetValue(id, net, duration) {
      const sign = net >= 0 ? "+" : "-";
      const absNet = Math.abs(net);
      let startTimestamp = null;
      const step = (timestamp) => {
        if (!startTimestamp) startTimestamp = timestamp;
        const progress = Math.min((timestamp - startTimestamp) / duration, 1);
        const currentValue = Math.floor(progress * absNet);
        document.getElementById(id).textContent = `${sign}₹${currentValue.toLocaleString('en-IN')} Cr`;
        if (progress < 1) {
          window.requestAnimationFrame(step);
        } else {
          document.getElementById(id).textContent = `${sign}₹${absNet.toLocaleString('en-IN')} Cr`;
        }
      };
      window.requestAnimationFrame(step);
    }

    // Update Header Figures
    const latestFii = fiiData[0];
    const latestDii = diiData[0];
    const fiiHeaderElem = document.getElementById("headerFii");
    fiiHeaderElem.classList.add(latestFii.net >= 0 ? "net-positive" : "net-negative");
    animateNetValue("headerFii", latestFii.net, 2000);
    const diiHeaderElem = document.getElementById("headerDii");
    diiHeaderElem.classList.add(latestDii.net >= 0 ? "net-positive" : "net-negative");
    animateNetValue("headerDii", latestDii.net, 2000);

    const latestDateObj = new Date(latestFii.date);
    const dayName = latestDateObj.toLocaleDateString('en-US', { weekday: 'long' });
    const dateName = latestDateObj.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });
    document.getElementById("latestDateText").textContent = `Latest Data as of ${dayName}, ${dateName}`;

    // Percentage Change
    const previousFii = fiiData[1];
    const previousDii = diiData[1];
    const fiiPctChange = ((latestFii.net - previousFii.net) / Math.abs(previousFii.net)) * 100;
    const diiPctChange = ((latestDii.net - previousDii.net) / Math.abs(previousDii.net)) * 100;
    document.getElementById("fiiChangeText").textContent =
      `${fiiPctChange >= 0 ? "↑" : "↓"} ${Math.abs(fiiPctChange).toFixed(2)}% from previous day`;
    document.getElementById("diiChangeText").textContent =
      `${diiPctChange >= 0 ? "↑" : "↓"} ${Math.abs(diiPctChange).toFixed(2)}% from previous day`;

    // Chart Configuration
    const fiiDataChrono = [...fiiData].reverse();
    const diiDataChrono = [...diiData].reverse();
    const ctx = document.getElementById("investmentChart").getContext("2d");
    new Chart(ctx, {
      type: "line",
      data: {
        labels: fiiDataChrono.map(d => d.date),
        datasets: [
          {
            label: "FII Net (₹ Cr)",
            data: fiiDataChrono.map(d => d.net),
            borderColor: "#1e40af",
            borderWidth: 3,
            tension: 0.4,
            pointRadius: 5,
            pointBackgroundColor: "#ffffff",
            pointBorderWidth: 2
          },
          {
            label: "DII Net (₹ Cr)",
            data: diiDataChrono.map(d => d.net),
            borderColor: "#10b981",
            borderWidth: 3,
            tension: 0.4,
            pointRadius: 5,
            pointBackgroundColor: "#ffffff",
            pointBorderWidth: 2
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          x: {
            title: { display: true, text: "Date", color: "#64748b", font: { weight: "600" } },
            grid: { display: false }
          },
          y: {
            title: { display: true, text: "Net Investment (₹ Cr)", color: "#64748b", font: { weight: "600" } },
            grid: { color: "#e2e8f0" }
          }
        },
        elements: {
          line: { tension: 0.4, borderWidth: 3 },
          point: { radius: 5, backgroundColor: '#ffffff', borderWidth: 2 }
        },
        plugins: {
          legend: {
            labels: { color: "#1e293b", font: { weight: "600" }, usePointStyle: true },
            position: "top"
          },
          tooltip: {
            callbacks: {
              label: (context) => {
                const label = context.dataset.label || "";
                const val = context.parsed.y;
                const sign = val >= 0 ? "+" : "-";
                const absVal = Math.abs(val).toLocaleString("en-IN");
                return `${label}: ${sign}₹${absVal} Cr`;
              }
            }
          }
        },
        animation: {
          duration: 1000,
          easing: 'easeOutQuart'
        }
      }
    });

    // Social Share Functions
    function shareOnFacebook() {
      window.open("https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(window.location.href), "_blank");
    }
    function shareOnTwitter() {
      window.open("https://twitter.com/intent/tweet?url=" + encodeURIComponent(window.location.href) + "&text=" + encodeURIComponent(document.title), "_blank");
    }
    function shareOnLinkedIn() {
      window.open("https://www.linkedin.com/sharing/share-offsite/?url=" + encodeURIComponent(window.location.href), "_blank");
    }
    function shareOnWhatsApp() {
      window.open("https://api.whatsapp.com/send?text=" + encodeURIComponent(document.title + " " + window.location.href), "_blank");
    }
    function shareOnTelegram() {
      window.open("https://t.me/share/url?url=" + encodeURIComponent(window.location.href) + "&text=" + encodeURIComponent(document.title), "_blank");
    }
    function copyLinkForInstagram() {
      copyLink();
      alert("Link copied! Paste it into your Instagram post or story.");
    }
    function copyLink() {
      navigator.clipboard.writeText(window.location.href).then(() => {
        alert("Link copied to clipboard!");
      });
    }

    // Download Snapshot Function
    function downloadSnapshot() {
      const format = document.getElementById("downloadFormat").value;
      if (format === "CSV") {
        const row = fiiData[0];
        const dRow = diiData[0];
        let csvContent = "Date,FII Buy,FII Sell,FII Net,DII Buy,DII Sell,DII Net\n";
        csvContent += `${row.date},${row.buy},${row.sell},${row.net},${dRow.buy},${dRow.sell},${dRow.net}\n`;
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        link.setAttribute("href", URL.createObjectURL(blob));
        link.setAttribute("download", "latest_snapshot.csv");
        link.click();
      } else {
        html2canvas(document.getElementById("snapshotArea")).then(canvas => {
          const ctx = canvas.getContext("2d");
          const watermarkText = "FIIDIIDATA.io";
          ctx.font = "20px Inter";
          ctx.fillStyle = "rgba(0,0,0,0.3)";
          ctx.textAlign = "right";
          ctx.fillText(watermarkText, canvas.width - 10, canvas.height - 10);
          let imageData;
          if (format === "JPEG") {
            imageData = canvas.toDataURL("image/jpeg");
          } else {
            imageData = canvas.toDataURL("image/png");
          }
          const link = document.createElement("a");
          link.setAttribute("href", imageData);
          link.setAttribute("download", `latest_snapshot.${format.toLowerCase()}`);
          link.click();
        });
      }
    }

    // Dark Mode Toggle
    const darkModeToggle = document.getElementById("darkModeToggle");
    darkModeToggle.addEventListener("change", function() {
      document.body.classList.toggle("dark-mode", this.checked);
    });

    // Scroll-to-top Button
    const scrollButton = document.querySelector(".scroll-to-top");
    window.addEventListener("scroll", () => {
      scrollButton.classList.toggle("show", window.scrollY > 300);
    });

    // Initialize Tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl);
    });
  </script>
</body>
</html>
